C51 COMPILER V9.51   FRACN_API                                                             10/22/2015 22:07:41 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE FRACN_API
OBJECT MODULE PLACED IN .\DP8051\DP8051_Keil_951\Debug\FracN_api.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.3\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\Generated_Source\PSoC3\FracN_api.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB WL(2) P
                    -R(.\DP8051\DP8051_Keil_951\Debug/FracN_api.lst) CD OT(5,SIZE) OJ(.\DP8051\DP8051_Keil_951\Debug\FracN_api.obj)

line level    source

   1          // ========================================
   2          // Copyright 2013 David Turnbull AE9RB
   3          //
   4          // Licensed under the Apache License, Version 2.0 (the "License");
   5          // you may not use this file except in compliance with the License.
   6          // You may obtain a copy of the License at
   7          //
   8          //     http://www.apache.org/licenses/LICENSE-2.0
   9          //
  10          // Unless required by applicable law or agreed to in writing, software
  11          // distributed under the License is distributed on an "AS IS" BASIS,
  12          // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  13          // See the License for the specific language governing permissions and
  14          // limitations under the License.
  15          // ========================================
  16          
  17          #include "FracN_api.h"
  18          #include <device.h>
  19          
  20          void FracN_Start2(uint8 dma) {
  21   1          uint8 td;
  22   1          
  23   1          FracN_Set(FracN_DEFAULT);
  24   1      
  25   1          td = CyDmaTdAllocate();
  26   1          CyDmaTdSetConfiguration(td, 1, td, 0);
  27   1          CyDmaTdSetAddress(td, LO16((uint32)FracN_PLL_P__STATUS_REG), LO16((uint32)&FASTCLK_PLL_P));
  28   1          CyDmaChSetInitialTd(dma, td);
  29   1          CyDmaChEnable(dma, 1);
  30   1      }
  31          
  32          void FracN_Set(uint16 frac) {
  33   1          CY_SET_REG8(FracN_FRAC_HI__CONTROL_REG, frac >> 8);
  34   1          CY_SET_REG8(FracN_FRAC_LO__CONTROL_REG, frac & 0xFF);
  35   1      }
C51 COMPILER V9.51   FRACN_API                                                             10/22/2015 22:07:41 PAGE 2   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION _FracN_Start2 (BEGIN)
                                           ; SOURCE LINE # 20
0000 900000      R     MOV     DPTR,#dma
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 23
0005 7FF4              MOV     R7,#0F4H
0007 7E3D              MOV     R6,#03DH
0009 120000      R     LCALL   _FracN_Set
                                           ; SOURCE LINE # 25
000C 120000      E     LCALL   CyDmaTdAllocate
000F 900000      R     MOV     DPTR,#td
0012 EF                MOV     A,R7
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 26
0014 E0                MOVX    A,@DPTR
0015 FB                MOV     R3,A
0016 FF                MOV     R7,A
0017 E4                CLR     A
0018 900000      E     MOV     DPTR,#?_CyDmaTdSetConfiguration?BYTE+04H
001B F0                MOVX    @DPTR,A
001C 7D01              MOV     R5,#01H
001E FC                MOV     R4,A
001F 120000      E     LCALL   _CyDmaTdSetConfiguration
                                           ; SOURCE LINE # 27
0022 900000      R     MOV     DPTR,#td
0025 E0                MOVX    A,@DPTR
0026 FF                MOV     R7,A
0027 7B22              MOV     R3,#022H
0029 7A42              MOV     R2,#042H
002B 7D66              MOV     R5,#066H
002D 7C64              MOV     R4,#064H
002F 120000      E     LCALL   _CyDmaTdSetAddress
                                           ; SOURCE LINE # 28
0032 900000      R     MOV     DPTR,#dma
0035 E0                MOVX    A,@DPTR
0036 FF                MOV     R7,A
0037 A3                INC     DPTR
0038 E0                MOVX    A,@DPTR
0039 FD                MOV     R5,A
003A 120000      E     LCALL   _CyDmaChSetInitialTd
                                           ; SOURCE LINE # 29
003D 900000      R     MOV     DPTR,#dma
0040 E0                MOVX    A,@DPTR
0041 FF                MOV     R7,A
0042 7D01              MOV     R5,#01H
0044 120000      E     LCALL   _CyDmaChEnable
                                           ; SOURCE LINE # 30
0047 22                RET     
             ; FUNCTION _FracN_Start2 (END)

             ; FUNCTION _FracN_Set (BEGIN)
                                           ; SOURCE LINE # 32
;---- Variable 'frac' assigned to Register 'R4/R5' ----
0000 AD07              MOV     R5,AR7
0002 AC06              MOV     R4,AR6
                                           ; SOURCE LINE # 33
0004 EC                MOV     A,R4
0005 906475            MOV     DPTR,#06475H
C51 COMPILER V9.51   FRACN_API                                                             10/22/2015 22:07:41 PAGE 3   

0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 34
0009 EF                MOV     A,R7
000A 906474            MOV     DPTR,#06474H
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 35
000E 22                RET     
             ; FUNCTION _FracN_Set (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     87    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       2
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
